package pdfTest.GM;

import cn.hutool.core.io.FileUtil;
import com.itextpdf.text.pdf.AcroFields;
import com.itextpdf.text.pdf.PdfReader;
import com.itextpdf.text.pdf.security.MakeSignature;
import lombok.SneakyThrows;
import org.junit.jupiter.api.Test;

import java.io.ByteArrayOutputStream;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

/**
 * @author TangHaoKai
 * @version V1.0 2024/8/5 14:36
 */
public class SignTest {
    private static final String ROOT = "src/main/java/pdfTest/GM";
    private static final Path pdfPath = Paths.get(ROOT, "sign.pdf");

    @Test
    @SneakyThrows
    public void makeSign() {
        Path path = Paths.get("C:\\Users\\ggk911\\IdeaProjects\\Gitee\\iText-GM\\target\\emptySignaturePdf.pdf");
        // Path path = Paths.get("src/main/java/pdfTest", "合同测试模板.pdf");
        String pkcs7Str1 = "3082278730821e4b02010430821e0130821a8c300f160245530201041606474d5345414c16203432626432343530653432643463366662333038666534343038663963663830308203830201030c27e6b7b1e59cb3e5b882e6b58be8af95e7a791e68a80e69c89e99990e585ace58fb8e585ace7aba00201013082031d0482031930820315308202bca003020102020f06c940bfe0af76dbe9033d4f501c60300a06082a811ccf55018375308188310b300906035504061302434e3112301006035504080c094775616e67446f6e673111300f06035504070c085368656e5a68656e31393037060355040a0c304469676974616c20436572746966696361746520417574686f72697a6174696f6e2043656e74657220436f2e204c74643117301506035504030c0e476c6f62616c2053756220434132301e170d3233303730373039313035375a170d3234303730363039313035375a3061310b300906035504061302434e3112301006035504080c09e5b9bfe4b89ce79c813112301006035504070c09e6b7b1e59cb3e5b882312a302806035504030c21e6b7b1e59cb3e5b882e6b58be8af95e7a791e68a80e69c89e99990e585ace58fb83059301306072a8648ce3d020106082a811ccf5501822d034200049b76e40a809a409c66fb3a3586f4279ccb7c30bcb9f82c6e91067534164e4d2ddc7d7e656b67d8c865e0450823d40d8efe6eb03783f3d58fa740549856744f11a382012d30820129300e0603551d0f0101ff0404030206c0300c0603551d130101ff04023000301f0603551d2304183016801477e37f028205eb8850df3f90e1166742c6de0f84301d0603551d0e04160414628f7fcb1863c1c16694ced0cc8f5dc262bbfb3830200603551d250101ff0416301406082b0601050507030206082b06010505070304303a0603551d1f04333031302fa02da02b8629687474703a2f2f3133392e392e38392e3131323a383038352f476c6f62616c5375624341322e63726c306b06082b06010505070101045f305d302406082b060105050730018618687474703a2f2f3133392e392e38392e3131323a38303832303506082b060105050730028629687474703a2f2f3133392e392e38392e3131323a383038352f476c6f62616c5375624341322e637274300a06082a811ccf5501837503470030440220673d8637eedc0006f4ed9a9b181e8267f2daf9b0e344b286ba4fbdc505ae1a060220493f91d23a95ec51f32954a74da293602e3419394af2f289dd37d8ca56163aae180f32303233303730373039313734345a180f32303233303730373039313734345a180f32303235303730373039313734345a308216ce1603504e47048216bf89504e470d0a1a0a0000000d49484452000000970000009708030000002f41394b000000017352474200aece1ce90000000467414d410000b18f0bfc610500000300504c5445ffffffff0000ffaaaaff5555ffe2e2ff1c1cff7171ff3838ffc6c6ff8d8dff0808ff0d0dff6868fff9f9fffbfbfffafaff0b0bfffdfdfff7f7ff1212fffcfcffeeeefff2f2fff5f5ff9494ff0f0ffff8f8ffa4a4ff1b1bff1f1fffe6e6ff1111ffe3e3ff4f4fff3737ff8e8efff6f6fff3f3fff0f0fff1f1ffc0c0ffafafff7070ff1e1eff3939ffe7e7ff2b2bffd8d8ff9c9cffc7c7ff3232ffcfcfffb2b2ff3e3eff3b3bff9393ff4545ff4242ffa3a3fff4f4ffeaeaffcdcdffd0d0ff5a5aff7f7fff3535ff4646ff5050ff4949ff2828ff1717ff4444ffc2c2ff2323ff2020ffd2d2ff9a9aff1313ffededff2a2aff6b6bff2424ff1d1dff4e4effc9c9ff5d5dff7474ffe8e8ff2626ff2121ff5454ff7272ff8c8cffc5c5ff4141ff9898ff6060ff7c7cffa6a6ffebebffececff4848ffa5a5ff8787ff5959ffdadaffa9a9ffefefff9999ff4747ff6d6dff8383ff7a7affccccffddddff4040ff2727ffb5b5ff6969ff2222ff5b5bff8a8affd7d7ffceceffd4d4ff2929ffbdbdffa7a7ff9292ff5151ffd1d1ffe9e9ff8181ff9f9fff2d2dffd6d6ff5858ff5e5effc3c3ff7676ff3333ff7575ff5353ff1515ff8888ffe5e5ff1818ff8585ffcacaff3f3fff7777ffadadffaeaeffdbdbff4b4bff9e9eff3c3cffb1b1ff9d9dff8686ff7b7bff6c6cffd3d3ff2e2eff9191ff2f2fffdfdfff0101ff5757ffdedeff9797ffc8c8ffa8a8ffd5d5ffe1e1ffa1a1ff7d7dff7e7eff6f6fffa0a0ff7878ff4343ffb0b0ffd9d9ffbabaff9b9bff5252ff9595ffc1c1ffacacffbcbcff4c4cff8080ff3636ff6262ff3030ff7373ff3131ff6a6aff9090ffb7b7ff6363ff3434ff6767ffe4e4ff8484ff0707ff0a0affb6b6ffdcdcff3d3dff8b8bff8989ff2525ff4a4aff6161ffcbcbff1414ffb9b9ff4d4dff6464ff7979ffb4b4ff1919ff2c2cff6565ff0e0eff0c0cff0303ffbfbfff8282ff8f8fff6666ff5f5fffb3b3ffbbbbffe0e0ff5c5cffbebeffababff9696ff0505ff0202ff6e6efffefeffc4c4ff5656ff1616ff0909ff1010ffa2a2ffb8b8ff0606808080808080808080ec6bbb1c0000000174524e530040e6d866000000097048597300000ec300000ec301c76fa8640000133b49444154785ecd9c77601347bac0e7936d61afb02c5b46b6dc3bc6c615c70d0ceec6c6c6d8a63763d37befbd86de5b80100884d021b410384268e9bde7d273ef525f927befda6b7fbc99d9596977b5ab62591cbf3fa499d9ddd94ff39529bb1ae43e1a8d9f97188d46c38efcab200281325e5e7eff1ae934da0e4c04753a681fae6cbe4ec824d041ebcbaef230de5a1f764b869797169b94156c62ec08c347ebcdaef51c7ee296c27a52539446aae70e7eacdc23786bd96d308ab663fa034bf04864f358a389a4f2b295a9cf04fca181b57cce8ac6aa548f48e66bf9e98a3ae95609b8ad34f014cb8bb1eabe437bfb80b7f0ab956d78f12880f255442e657bb3fa8a57bbb6991fabd547d97c9f33af8457d0f96415b982c8879f2059fb79802fabd29e534128ea0de314e5f23ec27f0beaf4691f650a2a64b65134686e0c4d48c172a175c6714a720d34d206c30836da1eca642ab468b027f870b1692c6385c8351d9e53902b317a7d0842014fd28ca04d7795293496c8da9b06e77024264881d00f662d830b0a72d57251f8737f23df6842b071afc9986549dcbb37cc5db1d39f6578564c9f0ec7605e609a827de91b0690afae754fd0ac4599ee5819d3a196cf8d617655508afcf2b16aac4ccd2e87075e2d0a7162017605dfc9087d0a39ac04c39aaccdbae475e823dc6a62241fcc9f84ac8d305bb0659e1c6c5f3df7dbca756d0244dc9b8b50af397a5642d0f06af06259d7f0e6dbbb83d5106ec130f215b8b43af5c86a5a62610a8e5fbfc12fb67a3c031ba2ffb1280632599ec7b66ea7f1e67f13d321cfcb581b81c94d91d09b1558b80175dd9031d756ae93f581892d0dd5ba20d36fac8487d7a58fcb8231b1a4b7494c1db02f7deacf01eb86b2020b75003b036e8006ce8af585d07928c49f93b9d47543645ad3d0fa5d158c77441b9f49de34311c7f3d09ddf8bc40063e1772f22a3470ec9844b094c630fc39dc30baff04b935a9dcc22ebee412f51fd3678eacc19a01e681a6d32cd208a481043ae97e1a9e87fc87f4c369a9a360984a5c108cbf4251ac44f2319c9335d8d87c085db93aac763394ff991521d4f7959f1a6048cbb7319360092b9262e7368af0e72b3bcbd51961c8b7ebfc39b7599e9208fb2174f11bbaca036283ec0f71d031a0fb9caf8d7b7a4c62655278b77456302616cb49f00faf83537173e00fddc0da2e08ddacd4436865f6dc40893fbe7afc029c40091109934a0cb1ac4c8e2b82d93977e3fbadb0bc77d8ba3274b43e809561b2b7e3fed1842d5c1a2702d34f2234f763840a61172b9263a70de4d0284fc5caac5acf1759094465eb105a0e4b266f8b4721197ca17fa93f1d4fc8e55a066710daf40a4a8b7e99955878937d33c19c88fcb44fe45bcbff12cc9376d098de38a8fad71c45937419450758194649aea95df147ee08fdec39097c81859e91648c81c7df82600efb4a3e4208be3b1ec64a3a6842492c0a186ee88b4ade0f587a829529cad513bae0e800a6625d1f5662216846761242514da49da4775481979e56bedb0b87d05aee50277ac0caeff074b8c67cf17aec90960f697f4951906b43030eb11935cb611c2b10b37764e22b662826491af91dd83e352ebe4f5c0ddcb29511f9ba7461e0c4f09ffff288e3f78ddb8a56e952cc82d06172b9e6ee1ec4bd80bfc3a339a5a91b0afe5807c6853d699af695764d8c1a17ef1dfe23bf88d3dd4cd7ed3256f2575bf0332c4e89815284dee560062b5b0dcbc997c632cc1a67c83762ab4a2a85975889849ebf02cca1319a4023801d13f326c7698b9a62cd5783130bb8e1b9dcc09ae88dfc6146a279da81dfe1779c7ad7ac6363c5b07df4ebdc4bc1f41b0b04788a1bb82fd5a06305220272a68261d8acb8f12ccfac475d93546eac89244d4ed603eeb03e6d337c3f15b477b8b3ec049e81baa5c608eaa83127a9852890002ff73d1b677eeb308c61258ce04ff74602f4c3669f36bf19050ca285d4c454a3183d4a8c4b3fcd0c9fe9e0aa0166c3b00dd0710face0cfe089829db574d06e87105368d705999d715811f5e3faa2e609a9637361f607e9449e0c9fd98683fc116a62229f91405ad3874f9a2eea6237408131ba0c86b6406c13ac09e40f50c6428289251d61827aeb40e2d48d2d07dfd4c2c709e8a938127f8a743aa11ed1bde550992d71246659704738d6a05bcf156c873d3fc22851840d58633b8154a34cea69415be1196283970e95e2cee0c5817c298b6292c1b100357a491d9300eea573eb7571cddceb5a28b589b04ed17fa8787a9e3412aec47d8813c9009df197b593a5114ac9f4a9d15b0fccf47a6bed15806fea61deb69a178c91295c577984750ef1f835ea019c46514332d1592efd022b63d06651307dda90a218a2dfb70eea9662a5a7c3fd74e394cae80bbaf489ec585b595209a407cf88e808b63f92c64edbee88b4a3d4f002c3eb7ae546d799ebe1adb8e68c6cffa2ba4ad9b0de45b28cc6d66d5fe150f1a3a25110d3b789fab419e5d226ae4eab8cadc70726cd4278749531df788e1d690b3986c8c751b78833fea3244e64816a4c6e61c4199502db4cc39138005df1f1c24501f1d1d0c48adb401e6493c1cdb2883dd2a0638558b8cc25697329c6b566383c725d362c30c0fcc165b98fb152d7190e23718cc753a4c1d2202d82c675698391e652096b370c7fbf36d17cbfd330ae221811df6e23abc350521ff47cbaac5313432c4cda60a444b943cf5a0ac66e680a1e082e79cd0da928d3fb15fd53360890405c52d23ac4e4549a2ba3e5e63f8d59fa8a3c967787bf1a0cf2419314d23c62e72341427dfc9351c9b58696b38c1ba419215f36c8b412405c9d34983854e02cb0a412453ad81bc1d2eed059adc70848ee17f11c494805218e2088a95732a2117525b90ebbc7a43fb2848b10a160b34f324913c559c302091cbc5a4794c0769a901110e84d1666ecb231b53b4bb90015aa6b7c8c7efbca77715423866e09a324780956ff12d84caa9ce526ec662967f19ffb0916eaa9eb99297b7400c34911b17c2184116b13c28677053e7d9ff2fa8b7df41b809a88b3f8cf1d150d8fe59d1f185950b6664a6bcf790b46e3521248050fb4aa11a1f88b0815439d768468f9c139ba7d04df393b8a45415d7a996176de20b43b9b4c553a877b19601e392056244e1227f01db5e77e52d7223c908818560111fd925d132df46d509cc1dad25d73520723a3472074e657732b162a96e362c3aff37d1c1306c3bc31f9c0d85c5d019cee8466e233fa5c7455b4c770355b59da1ebfc51aa06a4ac60028de5401ff38878532e457e320101c49674e568f14ab34ef230eaa5692812e166dd766889e4694ee0c51cfe26a76b28c3dd27a35e33096361560c82757623918aae98e2a66e103da23277033588d5d6c5e8ff5ef1c3e14b039f2f3ba599b20d2c9d1f32d5c0bd82ea0ab33717b01e87a4d699c89d317e30367eeada631d46a60a43e9a40684c2436c23e7734d80a1fcb23739e56802ff9438e5840aa813758ce11a3a75461a1babc372d75f60cacc2cb3bab2152bb852e4709e28883fd14d282bb3e20a6b95e87c3ddbfcfd88d8499bd7d4cd8ea317358d63e39f7207a4097a01efd765e4c8ca9f0d54642f5de99c27d04031347afaa56a40fdf36832a11bb32158d1e70c8082a16fc9f75454c1d1c51b8e3898187a33fef81d0056c677b678a06b082b98bbaa484b273a873e64aacc4783ae90bea32201ab25b9c71ca2d542c805d4e356fc2a73f14e4ea36d547cc8e9d91e72bbd44d09fb4ab2474df475b8a89d64bf7292db58bbe864a853d865fa0744854b611f75abe878cc4ec25087291daf81211bc12b713f74541b8b51d81a7e63cef5c6325f6313de0fe4ebefd17d1ac04528df5cb062ada662717227e25b550be6725f69900e4d18c32a416a93bcac1a2d16540c74490ca28e5ce4c023274d09f256de10dcb9e5c18e5999e9ca7ff8dca4448954f8e11fadbdf58c28aff61f561262f97384c38c7a2bf769443fa46c6b32359998537325d1b2ff272d9baa323fc7f78874ae02c77d455a608af41d7e5426887a87d1cf289d25a843dda2e17320d35d07b3ae6ed4fd825cee3865c08ed1b4c6feb8821abd8f92ee0965c086df84f7a677b185ada30437246aec4f33fff2f4bdad0694d24bdb93a4be3fbb2736d08987561079feafbb17c6580974b3c2a64e83b3db1fc850f474d8dc393278065acd496178de4b82a8daba4ef2c88590cf051169fcc78304ddad149dbab933e2c2aab30b4a5ace01b52a9a1a474ebf8dad6253de48f0ec5f4e84806cf2a4ca7cb5d6a8c84bda943f965d104ad798678502c912bec0eadac31b7695afcda3f9e2713aee0c9cfb7fec29faa46c89a3fd1cb6c4975b0fe3310ce876ce26ef7a6fdc9e202c351ebd2ad44ae5f52f2c2fbaf26737dffd1abc6354f5f59954daae7a42fa4da72ea19729a9c67cbdf63c7d5380ed825620640fa41ea1a3905b0f903360495db7ddaddf894a6f71b49bde60ee57717669e7da2af1331710db94046a6cd4b1c720ef2eb43e70670ba5173c95dfa0f30c03d2d79ab4e2ed75698333276e08ac2113b5c7ab2b1964a22e567764c9d563a8bc5fa891966869ae749a6f3ffcc7f9f3c2190c9151045c40ed99135ae79fca8a6aa3dc772f3efd63267b647139544ca4f0edbf9d5b2cec9c3c79690b0fbe625c11fa3a803f37259c613bb06de1ddbc14c6a6dcc2ddf9a52ccdd4fb95d0de5b6c31629ef598738566aecafec449dac2ac1671dda6f0924ddcfac8d2f267f76785a3efef285c8d9652d7fc9ab5fc116ba42e3b0f3eec82be968df56c8f4c516b5a5709ee0d3b9f7a6eec222f0b9e46158ca88fc2ffc6a43c9235ca95c26bee9e38d7e38409cba96b9f02e974edfdb4866f14f05f2c36df9d1b9f1242671e110d00d582b9aae30cb22d590ecac3183fa879f2e2ea9e13d3f22f7c0d7c62ef4447b8cf90f7ab69c750af309655240576c79004f21d75bbf820f91043c13b7b3f87478ff34a2cc551cd49213ed21f2c63f95587bf27778177702fd9dc7594a805c8fbf58b3157d5fbbfcbdc97a141569edd50a47b0842aab4b492d94a53f9c10f5e4c39c56a41cc1b02c818227ec5b7b3da29c3f6fa35260682f6dedc9ab64af01388f2097eb130f11e3a91098517c2f3dfa360b1bfffd2ecdb701617d4290af2d044ca042c03ba759010a9ace7af28eacc0652cfa23b5d012d759dc402e7eb6fc14cb13584ffe1d0b832e432ea6098591a1b3649228f1dd3c69505872f2bf48dd360b22ce615d2f14afafda726292ba6705bc862fcdd6c867fea6cb83f17851ed0d190758cdddbe81ad80952c650b799ff22a7b994f42169e603ec3d28af4505d531385079c5235307d45740cd287d381880dcbb9ca78e591c3e42d6fdbb58dc2d7d57a379130f60c2c136ea1acd781fc15c296a1dfa84e4af4399fa5b0a41213ebe15bc56535f1f30ee5081648c65e4b742ff518004b956fdffd2d7bc133693a4b28628a369a872bb4b5d8d8c5cfd3acc497e3ba8fbdb6dd1cddec7094e7344909a38f2f46c14168c6b4be4761f08bacd88af8799aa222fb73d0256424d4c051d5c9691bf80a60fed328a4e1602a1edc75cb87266110c6903c7f54f048ff9c8989be0d6301f28bdeecf242e8e522d79e61a9e2df00afe2cfae504f461181d37c8e9a026fd327b53cb2ce1ae7241ed933755b0f945801ba05bdbe4ecddf5a3c7de09532d11f47dce0f11ac3912014782b92db624209a93d111a3158642632418898e2d05a61ee1612de68d0a57ff9159d094fd672c0ff31c96d42b67091b7f024fb88a131fccb6978dc17273232e28162c511b532cb4fd8fad4f042280c03b8e13dfe0b5a1474d308531d4d709d67512c94f6c1de861b63238e64f4959fd1fc4280fcfd09d1fb265ad81c3abe142d6ab88e05aa0ec71e1ddf0813dafcd05b91eb0d903219a129715b024d83e970359bbc834b9b4b1a1848d8a025fe97fbbd81427bf68d0909c1038227631e4fc153377b11b24d842d341b0fd371f126fa2a73723acd90d6910652d1fb4c41d545a81359a6e43e9f78ad1c3e0fef9baffc6f03b7885a00af638d3dcf91d77502eae9734b1216e42f8091066381a34bd740bfaa85aff618b470c8e08564fee4fccb97ae90150713a25e834378b852cbff8d85845179bf237e5faeb430f36a66d682cf369465b7f11512a7d01facd38defde598f3aa5d";
        String pkcs7Str2 = "24622ce67f3be1c0d15cce6c6014442dc65532d689d7b28da5692b45c359ea2a65ca139625db6e32d2a2d75c931d5cf0dba541082026a2ed1239ea4cf5838a0194c072bc41995863544bb7c33ead140f00a46bd0bdaafbf5667ff7ca0ff22a18664ed1aadd0037c3b8e867958814f88173d3d87a92a9684306247b6d645202ec937e45ff21f464b49a066643b08a410c3a3a6bfffe1b49418cbbd15a0714d45660f4375251ae048a1a6af7ad483d01651327a1e6afa0efe31e3091cfdbf838f21ea727b0aaa27f5a935867aebc336316a5cea336b82e8ff560f0d6a5c8eac87c611a5eec0633879476a620fd1f69dfc3f1f33b18726182f967de36250ef784882f1623917015c39d75d5c6a032698e75bccb5ff230b82795c95aedf86f75d0f0bc68be55a4c6acb9ff75da46db7603fc673919f46f936a88409e6a9be92f6896db21437f6d470887b75d3c86fdddfa4fd706b7f130ced2bdb5f97bc0e9de913d550da3fc75dda61ff1c6c08bc2edb6f4bb1f6d96f08c374a9b2c396abb4d7fe4c18d97e56eed09efb59619895b9bba95e3befff4560ca74479b1ed82f0d2328b38d7b247a6a7f398c83fdf8ece1c1fdf808f6f72f54c3d3fb17121ceef728e3e1ecf7487924f7c7a43c9afb89521ec9fd57198fe27eb5028fe2febe563cb01f3242ff0fa6f31fdb1690d01d0000000049454e44ae4260820201280201280482031930820315308202bca003020102020f06c940bfe0af76dbe9033d4f501c60300a06082a811ccf55018375308188310b300906035504061302434e3112301006035504080c094775616e67446f6e673111300f06035504070c085368656e5a68656e31393037060355040a0c304469676974616c20436572746966696361746520417574686f72697a6174696f6e2043656e74657220436f2e204c74643117301506035504030c0e476c6f62616c2053756220434132301e170d3233303730373039313035375a170d3234303730363039313035375a3061310b300906035504061302434e3112301006035504080c09e5b9bfe4b89ce79c813112301006035504070c09e6b7b1e59cb3e5b882312a302806035504030c21e6b7b1e59cb3e5b882e6b58be8af95e7a791e68a80e69c89e99990e585ace58fb83059301306072a8648ce3d020106082a811ccf5501822d034200049b76e40a809a409c66fb3a3586f4279ccb7c30bcb9f82c6e91067534164e4d2ddc7d7e656b67d8c865e0450823d40d8efe6eb03783f3d58fa740549856744f11a382012d30820129300e0603551d0f0101ff0404030206c0300c0603551d130101ff04023000301f0603551d2304183016801477e37f028205eb8850df3f90e1166742c6de0f84301d0603551d0e04160414628f7fcb1863c1c16694ced0cc8f5dc262bbfb3830200603551d250101ff0416301406082b0601050507030206082b06010505070304303a0603551d1f04333031302fa02da02b8629687474703a2f2f3133392e392e38392e3131323a383038352f476c6f62616c5375624341322e63726c306b06082b06010505070101045f305d302406082b060105050730018618687474703a2f2f3133392e392e38392e3131323a38303832303506082b060105050730028629687474703a2f2f3133392e392e38392e3131323a383038352f476c6f62616c5375624341322e637274300a06082a811ccf5501837503470030440220673d8637eedc0006f4ed9a9b181e8267f2daf9b0e344b286ba4fbdc505ae1a060220493f91d23a95ec51f32954a74da293602e3419394af2f289dd37d8ca56163aae06082a811ccf550183750348003045022100cdfbda2e214e357772205eabfd024c516c16de17250eab979fa1059e2d67b09c02205d62dc8cc668b60b9bf1b8fb2d4e6a36c2b714e70e4caa30a4e653a91f64ec40180f32303233303730373039313833335a0321001f2084e0fa11df803be7572966021a8095206f872b1ff6ca380673a5a967b3c1160d5369676e61747572652e786d6c0482031930820315308202bca003020102020f06c940bfe0af76dbe9033d4f501c60300a06082a811ccf55018375308188310b300906035504061302434e3112301006035504080c094775616e67446f6e673111300f06035504070c085368656e5a68656e31393037060355040a0c304469676974616c20436572746966696361746520417574686f72697a6174696f6e2043656e74657220436f2e204c74643117301506035504030c0e476c6f62616c2053756220434132301e170d3233303730373039313035375a170d3234303730363039313035375a3061310b300906035504061302434e3112301006035504080c09e5b9bfe4b89ce79c813112301006035504070c09e6b7b1e59cb3e5b882312a302806035504030c21e6b7b1e59cb3e5b882e6b58be8af95e7a791e68a80e69c89e99990e585ace58fb83059301306072a8648ce3d020106082a811ccf5501822d034200049b76e40a809a409c66fb3a3586f4279ccb7c30bcb9f82c6e91067534164e4d2ddc7d7e656b67d8c865e0450823d40d8efe6eb03783f3d58fa740549856744f11a382012d30820129300e0603551d0f0101ff0404030206c0300c0603551d130101ff04023000301f0603551d2304183016801477e37f028205eb8850df3f90e1166742c6de0f84301d0603551d0e04160414628f7fcb1863c1c16694ced0cc8f5dc262bbfb3830200603551d250101ff0416301406082b0601050507030206082b06010505070304303a0603551d1f04333031302fa02da02b8629687474703a2f2f3133392e392e38392e3131323a383038352f476c6f62616c5375624341322e63726c306b06082b06010505070101045f305d302406082b060105050730018618687474703a2f2f3133392e392e38392e3131323a38303832303506082b060105050730028629687474703a2f2f3133392e392e38392e3131323a383038352f476c6f62616c5375624341322e637274300a06082a811ccf5501837503470030440220673d8637eedc0006f4ed9a9b181e8267f2daf9b0e344b286ba4fbdc505ae1a060220493f91d23a95ec51f32954a74da293602e3419394af2f289dd37d8ca56163aae06082a811ccf550183750348003045022001bb9f5940972a33de824948307521e6da82b447f7764aa6307780f44b1a2c5b022100d17cd8b4ed0b918f2ef9414d43f20b84e95109e9124a5ffb041727157b7f07c7a08205c3038205bf00308006092a864886f70d010702a080308205a7020103310e300c06082a811ccf5501831105003075060b2a864886f70d0109100104a0660464306202010106082b060105050703083030300c06082a811ccf5501831105000420d265fafbca92f2119ced8d04b23cfa122098cab7891f7f3d6d581030802210ab020a3d2b506b618eb2c5985b180f32303233303730373039313833355a0204e26e3e1aa082035930820355308202fca003020102020a3d2b506b618eb2c5985b300a06082a811ccf550183753064310b300906035504061302434e31363034060355040a0c2d4469676974616c20436572746966696361746520417574686f726974792043656e74657220436f2e2c204c7464311d301b06035504030c14476c6f62616c2054696d655374616d7020434132301e170d3231313131363033343731305a170d3236313131353033343731305a3074310b300906035504061302434e31363034060355040a0c2d4469676974616c20436572746966696361746520417574686f726974792043656e74657220436f2e2c204c7464312d302b06035504030c24476c6f62616c2054696d655374616d70205369676e20526573706f736e65202d20534d323059301306072a8648ce3d020106082a811ccf5501822d03420004faec9281a9e9a3b18bf6a2c607f6771c78af00e0f7ddf96db68e21d25e460e3d9b0c17149eb7a658f2a7be3e17c17a9ce02124a268e81b57435053a4a147dc3ba382018430820180300e0603551d0f0101ff0404030206c0300c0603551d130101ff04023000301f0603551d23041830168014f873ccc7361b6b0d6bbc62d2fe09e6204f60756a301d0603551d0e041604145e9b9fef4ec514244ff251f0d8792e62bca442ed30160603551d250101ff040c300a06082b0601050507030830420603551d1f043b30393037a035a0338631687474703a2f2f63726c2e6a696564616e62612e636e2f63726c2f476c6f62616c54696d655374616d704341322e63726c30818106082b0601050507010104753073303206082b060105050730018626687474703a2f2f6f6373702e6a696564616e62612e636e2f6f6373702f6f6373705175657279303d06082b060105050730028631687474703a2f2f6372742e6a696564616e62612e636e2f6372742f476c6f62616c54696d655374616d704341322e63727430400603551d2004393037303506096086480186fd6c01013028302606082b06010505070201161a687474703a2f2f6370732e6a696564616e62612e636e2f637073300a06082a811ccf5501837503470030440220370cd958bb50140daa8210267742010c10c71b7710daf0d9957921642ebbb71e022044d8fcdd422a7a1a3cc40b5518f1836275a3c0e0c1f3696248deb1fb8defcaa8318201bc308201b802010130723064310b300906035504061302434e31363034060355040a0c2d4469676974616c20436572746966696361746520417574686f726974792043656e74657220436f2e2c204c7464311d301b06035504030c14476c6f62616c2054696d655374616d7020434132020a3d2b506b618eb2c5985b300c06082a811ccf550183110500a081db301a06092a864886f70d010903310d060b2a864886f70d0109100104301c06092a864886f70d010905310f170d3233303730373039313833355a302906092a864886f70d010934311c301a300c06082a811ccf550183110500a10a06082a811ccf55018375302f06092a864886f70d01090431220420494dd3fffc2b26665ef8eb2220bda19e8766508fcf63020101bca5e62ff686fd3043060b2a864886f70d010910022f313430323030302e300a06082a811ccf550183110420be3d24ce883e7725b27bd396f6245db292c5bb75a3a64d45e3d30e8777afc68e300a06082a811ccf550183750447304502200c0ad436731039576423b122c49891170802433fa4d92a6a7a0a876be1d22285022100db78bfc252afe5f2fbb400d6e6d265b3ceb1da76b1dcb00c0de60081d2de72d200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
        byte[] pcks7 = (pkcs7Str1 + pkcs7Str2).getBytes(StandardCharsets.UTF_8);
        byte[] pdfBytes = Files.readAllBytes(path);
        PdfReader reader = new PdfReader(pdfBytes);
        AcroFields acroFields = reader.getAcroFields();
        acroFields.getSignatureNames();
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        MakeSignature.signDeferred(reader, "Signature1", baos, new MyExternalSignatureContainer(pcks7));
        byte[] bytes = baos.toByteArray();

        FileUtil.writeBytes(bytes, pdfPath.toAbsolutePath().toString());
    }
}
