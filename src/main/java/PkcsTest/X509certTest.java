package PkcsTest;

import cn.com.mcsca.pki.core.util.CertVerifyUtil;
import cn.hutool.core.io.FileUtil;
import lombok.SneakyThrows;
import org.bouncycastle.asn1.ASN1InputStream;
import org.bouncycastle.asn1.ASN1ObjectIdentifier;
import org.bouncycastle.asn1.ASN1Primitive;
import org.bouncycastle.asn1.ASN1Sequence;
import org.bouncycastle.asn1.DERBitString;
import org.bouncycastle.jce.provider.BouncyCastleProvider;
import org.bouncycastle.util.encoders.Base64;
import org.bouncycastle.util.encoders.Hex;
import org.junit.jupiter.api.Test;

import java.io.ByteArrayInputStream;
import java.io.File;
import java.nio.charset.StandardCharsets;
import java.security.Provider;
import java.security.Security;
import java.security.Signature;
import java.security.cert.Certificate;
import java.security.cert.CertificateFactory;

/**
 * @author TangHaoKai
 * @version V1.0 2024/1/23 15:57
 **/
public class X509certTest {

    private static final Provider BC = new BouncyCastleProvider();

    @Test
    @SneakyThrows
    public static boolean certTest(String cert, String middleCertBase64) {
        // public void certTest() {
        Security.addProvider(new BouncyCastleProvider());
        // String cert = "MIIC2jCCAkOgAwIBAgIBAzANBgkqhkiG9w0BAQUFADBYMQswCQYDVQQGEwJDTjEOMAwGA1UECgwFQ2hpbmExFTATBgNVBAsMDEludGVybWVkaWF0ZTEiMCAGCSqGSIb3DQEJARYTMTM5ODMwNTM0NTVAMTYzLmNvbTAeFw0yNDAxMjMwNzIwMzJaFw0yNTAxMjIwNzIwMzJaMGYxCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVDaGluYTESMBAGA1UEBwwJQ2hvbmdxaW5nMQ8wDQYDVQQDDAZHR0s5MTExIjAgBgkqhkiG9w0BCQEWEzEzOTgzMDUzNDU1QDE2My5jb20wWjANBgkqhkiG9w0BAQEFAANJADBGAkEAtKfkYXBXTxapcIKyK+WLaipil5hBm+EocqS9umJs+umQD3ar+xITnc5d5WVk+rK2VDFloEDGBoh0IOM9ke1+1wIBEaOB6zCB6DAdBgNVHQ4EFgQU0GzsbTWDvFUSGwzLPv7XJqYWZGgwHwYDVR0jBBgwFoAUlAgzbzJA94c32tEgqu0up27JyR4wCQYDVR0fBAIwADBfBggrBgEFBQcBAQEB/wRQME4wKAYIKwYBBQUHMAGCHGh0dHA6Ly8xMjcuMC4wLjEvY2Fpc3N1ZS5odG0wIgYIKwYBBQUHMAKCFmh0dHA6Ly8xMjcuMC4wLjE6MjA0NDMwDgYDVR0PAQH/BAQDAgbAMBIGA1UdEwEB/wQIMAYBAf8CAQMwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwgwDQYJKoZIhvcNAQEFBQADgYEAKqpSf7BFMOeWBHEuw7qR3SiNmBDPVYcSTQtKrY5z6dU1Dcz3M4pcTT2SGwQtEEAKwZsJOe2aACTkyXAoMCQed6NCeuIfBTSC4m7S10afTYKMoYYmJsgIWbxnnT91aEpJEBOqwYy2WhfunTFAQKRerBbjTixEOqIsSywUgBrodwA=";
        // String middleCertBase64 = "MIICgzCCAeygAwIBAgIBAjANBgkqhkiG9w0BAQUFADAqMQswCQYDVQQGEwJDTjEOMAwGA1UECgwFQ2hpbmExCzAJBgNVBAsMAkNBMB4XDTI0MDEyMzA3MjAzMloXDTI5MDEyMTA3MjAzMlowWDELMAkGA1UEBhMCQ04xDjAMBgNVBAoMBUNoaW5hMRUwEwYDVQQLDAxJbnRlcm1lZGlhdGUxIjAgBgkqhkiG9w0BCQEWEzEzOTgzMDUzNDU1QDE2My5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAI3g0RPF5zaWnI0rBHokP4/hjtrWTN6ehC02aSMMpIb3z93h+O7FTRkF//BKzIXmEJPhgMrcbOpAfxk9RLsOlEm427SXhM2eNiYMOeBqlHKZl4xu2DAHJOiHGYz+3iDz+95lj6K9B4vpRqOSvTSfK0nEhuIMQFWI4wZwbJAXMI5pAgMA//+jgYowgYcwHQYDVR0OBBYEFJQIM28yQPeHN9rRIKrtLqduyckeMFIGA1UdIwRLMEmAFMA2GQetxIiXqF5yb2sJ6+Xm8SlcoS6kLDAqMQswCQYDVQQGEwJDTjEOMAwGA1UECgwFQ2hpbmExCzAJBgNVBAsMAkNBggEBMBIGA1UdEwEB/wQIMAYBAf8CAQAwDQYJKoZIhvcNAQEFBQADgYEArn/OqlUQhidMXWDTbbtYt3wzvSFESbgX3DSOv/WxKcp/FyUElLzZPZbMOKqOWQsZxphvNCGHCj026aclM5Q7Uuv0pfXFMj2L64hDruCirtQV2NrdKCCx4koM7I8hElXKXUzVohJymqWswpVosup0/n5rZXtONP8Y0w8Vfm1fKnk=";
        // cert = "MIIDAjCCAqagAwIBAgIQKkCocV5WwHZ1MELsL9QOqDAMBggqgRzPVQGDdQUAMC0xCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVNQ1NDQTEOMAwGA1UEAwwFTUNTQ0EwHhcNMjQwNzAzMDIwNjI0WhcNMjUwNzAzMDIwNjI0WjB7MQswCQYDVQQGEwJDTjEOMAwGA1UECgwFTUNTQ0ExEDAOBgNVBAsMB2xvY2FsUkExGzAZBgNVBAUMEjM3MTcyNDIwMDIwNjA1MjIxMDEtMCsGA1UEAwwkMTM5OTg5Nzk1MTI5MTc0NDI1NkDllJDlpb3lh69AMDFAMDAyMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAE/H6jLJyBMGx3KRf7Fm/t+XPb7RF+RM4xWp0aqUq7Trlb+PucOYefUJATKJmdNI5mvnL7DXYXsIlFgnvWP2z/1KOCAVYwggFSMB0GA1UdDgQWBBQ+rcmJuBPRVSCzLqGNQQtHm1X0TjBEBgNVHSAEPTA7MDkGByqBHIeECwEwLjAsBggrBgEFBQcCARYgaHR0cHM6Ly93d3cubWNzY2EuY29tLmNuL2Nwcy5odG0wgbwGA1UdHwSBtDCBsTAuoCygKoYoaHR0cDovL3d3dy5tY3NjYS5jb20uY24vc20yL2NybC9jcmwxLmNybDB/oH2ge4Z5bGRhcDovL3d3dy5tY3NjYS5jb20uY246MTAzODkvQ049Y3JsMSxPVT1DUkwsTz1NQ1NDQSxDPUNOP2NlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3Q/YmFzZT9vYmplY3RjbGFzcz1jUkxEaXN0cmlidXRpb25Qb2ludDAfBgNVHSMEGDAWgBS5I+Ycf8+3PFgkW6QKrYoRl3p7tjALBgNVHQ8EBAMCBsAwDAYIKoEcz1UBg3UFAANIADBFAiBDen3zh/GTobiF9bJaWc/tjf0nwgzNtBXU2YqOCbbStgIhAJoKDaAY8kCDChIuVyN5kDXugJVMaaS4S+2PpPMj2nyD";
        // middleCertBase64 = "MIICgTCCAiWgAwIBAgIQVn7l0kAA6S9mVsDdu6k+oTAMBggqgRzPVQGDdQUAMC4xCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVOUkNBQzEPMA0GA1UEAwwGUk9PVENBMB4XDTE4MTEwNTAyMzU0N1oXDTM4MTAzMTAyMzU0N1owLTELMAkGA1UEBhMCQ04xDjAMBgNVBAoMBU1DU0NBMQ4wDAYDVQQDDAVNQ1NDQTBZMBMGByqGSM49AgEGCCqBHM9VAYItA0IABGL17gBv7xGY99pYA8IFH3H3VxbulydJGz5Fu3nYnx2FiU4BG8qLNCib5hnKzG6nVgeNel1IVKrsTX86CDQ6lj6jggEiMIIBHjAfBgNVHSMEGDAWgBRMMrGX2TMbxKYFwcbli2Jb8Jd2WDAPBgNVHRMBAf8EBTADAQH/MIG6BgNVHR8EgbIwga8wQaA/oD2kOzA5MQswCQYDVQQGEwJDTjEOMAwGA1UECgwFTlJDQUMxDDAKBgNVBAsMA0FSTDEMMAoGA1UEAwwDYXJsMCqgKKAmhiRodHRwOi8vd3d3LnJvb3RjYS5nb3YuY24vYXJsL2FybC5jcmwwPqA8oDqGOGxkYXA6Ly9sZGFwLnJvb3RjYS5nb3YuY246Mzg5L0NOPWFybCxPVT1BUkwsTz1OUkNBQyxDPUNOMA4GA1UdDwEB/wQEAwIBBjAdBgNVHQ4EFgQUuSPmHH/PtzxYJFukCq2KEZd6e7YwDAYIKoEcz1UBg3UFAANIADBFAiEA2HUeRfOn8spFQIkj9zbhVfc0qx9R8lwP40QcRWHIcMcCIHzDLXW5xAkevJaXFcsZJ/Q6CmXK5X+Soq+W/7+DaO8p";
        // cert = "MIIC/zCCAqOgAwIBAgIQGyeCk4o979VZ0RDhHHU48zAMBggqgRzPVQGDdQUAMC0xCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVNQ1NDQTEOMAwGA1UEAwwFTUNTQ0EwHhcNMjQwNTIwMDkwODMwWhcNMjUwNTIwMDkwODMwWjB4MQswCQYDVQQGEwJDTjEOMAwGA1UECgwFTUNTQ0ExEDAOBgNVBAsMB2xvY2FsUkExGzAZBgNVBAUMEjQyMDI4MTE5ODQxMTI1MTI2MzEqMCgGA1UEAwwhMTc4NDQ4Nzc0Njk1ODcwMDU0NUDorrjmhadAMDFAMDAxMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAEpvn+9wFZ48XD15KoQp3CTfoww2acsY+MW46v8K1dgMw2wWpwt6FTYAfzMSk3hzKMKJVXkjS1SwW3ksm2azrI9KOCAVYwggFSMB8GA1UdIwQYMBaAFLkj5hx/z7c8WCRbpAqtihGXenu2MB0GA1UdDgQWBBQfVOIxUyQ2zi20M0uO5g4imnn7IzBEBgNVHSAEPTA7MDkGByqBHIeECwEwLjAsBggrBgEFBQcCARYgaHR0cHM6Ly93d3cubWNzY2EuY29tLmNuL2Nwcy5odG0wCwYDVR0PBAQDAgTwMIG8BgNVHR8EgbQwgbEwLqAsoCqGKGh0dHA6Ly93d3cubWNzY2EuY29tLmNuL3NtMi9jcmwvY3JsMS5jcmwwf6B9oHuGeWxkYXA6Ly93d3cubWNzY2EuY29tLmNuOjEwMzg5L0NOPWNybDEsT1U9Q1JMLE89TUNTQ0EsQz1DTj9jZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0P2Jhc2U/b2JqZWN0Y2xhc3M9Y1JMRGlzdHJpYnV0aW9uUG9pbnQwDAYIKoEcz1UBg3UFAANIADBFAiCAP8XU1X7pNqkL4sd5HRUbnJqwLd4xlImNCFhSg6kiowIgWHDJXsZt9oeu1pm8E+9gt0mzWKACUXssvPB/L40MKb4A";
        // cert = "MIIC/zCCAqOgAwIBAgIQGyeCk4o979VZ0RDhHHU48zAMBggqgRzPVQGDdQUAMC0xCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVNQ1NDQTEOMAwGA1UEAwwFTUNTQ0EwHhcNMjQwNTIwMDkwODMwWhcNMjUwNTIwMDkwODMwWjB4MQswCQYDVQQGEwJDTjEOMAwGA1UECgwFTUNTQ0ExEDAOBgNVBAsMB2xvY2FsUkExGzAZBgNVBAUMEjQyMDI4MTE5ODQxMTI1MTI2MzEqMCgGA1UEAwwhMTc4NDQ4Nzc0Njk1ODcwMDU0NUDorrjmhadAMDFAMDAxMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAEpvn+9wFZ48XD15KoQp3CTfoww2acsY+MW46v8K1dgMw2wWpwt6FTYAfzMSk3hzKMKJVXkjS1SwW3ksm2azrI9KOCAVYwggFSMB8GA1UdIwQYMBaAFLkj5hx/z7c8WCRbpAqtihGXenu2MB0GA1UdDgQWBBQfVOIxUyQ2zi20M0uO5g4imnn7IzBEBgNVHSAEPTA7MDkGByqBHIeECwEwLjAsBggrBgEFBQcCARYgaHR0cHM6Ly93d3cubWNzY2EuY29tLmNuL2Nwcy5odG0wCwYDVR0PBAQDAgTwMIG8BgNVHR8EgbQwgbEwLqAsoCqGKGh0dHA6Ly93d3cubWNzY2EuY29tLmNuL3NtMi9jcmwvY3JsMS5jcmwwf6B9oHuGeWxkYXA6Ly93d3cubWNzY2EuY29tLmNuOjEwMzg5L0NOPWNybDEsT1U9Q1JMLE89TUNTQ0EsQz1DTj9jZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0P2Jhc2U/b2JqZWN0Y2xhc3M9Y1JMRGlzdHJpYnV0aW9uUG9pbnQwDAYIKoEcz1UBg3UFAANIADBFAiEAgD/F1NV+6TapC+LHeR0VG5yasC3eMZSJjQhYUoOpIqMCIFhwyV7GbfaHrtaZvBPvYLdJs1igAlF7LLzwfy+NDCm+";
        // middleCertBase64 = "MIICgTCCAiWgAwIBAgIQVn7l0kAA6S9mVsDdu6k+oTAMBggqgRzPVQGDdQUAMC4xCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVOUkNBQzEPMA0GA1UEAwwGUk9PVENBMB4XDTE4MTEwNTAyMzU0N1oXDTM4MTAzMTAyMzU0N1owLTELMAkGA1UEBhMCQ04xDjAMBgNVBAoMBU1DU0NBMQ4wDAYDVQQDDAVNQ1NDQTBZMBMGByqGSM49AgEGCCqBHM9VAYItA0IABGL17gBv7xGY99pYA8IFH3H3VxbulydJGz5Fu3nYnx2FiU4BG8qLNCib5hnKzG6nVgeNel1IVKrsTX86CDQ6lj6jggEiMIIBHjAfBgNVHSMEGDAWgBRMMrGX2TMbxKYFwcbli2Jb8Jd2WDAPBgNVHRMBAf8EBTADAQH/MIG6BgNVHR8EgbIwga8wQaA/oD2kOzA5MQswCQYDVQQGEwJDTjEOMAwGA1UECgwFTlJDQUMxDDAKBgNVBAsMA0FSTDEMMAoGA1UEAwwDYXJsMCqgKKAmhiRodHRwOi8vd3d3LnJvb3RjYS5nb3YuY24vYXJsL2FybC5jcmwwPqA8oDqGOGxkYXA6Ly9sZGFwLnJvb3RjYS5nb3YuY246Mzg5L0NOPWFybCxPVT1BUkwsTz1OUkNBQyxDPUNOMA4GA1UdDwEB/wQEAwIBBjAdBgNVHQ4EFgQUuSPmHH/PtzxYJFukCq2KEZd6e7YwDAYIKoEcz1UBg3UFAANIADBFAiEA2HUeRfOn8spFQIkj9zbhVfc0qx9R8lwP40QcRWHIcMcCIHzDLXW5xAkevJaXFcsZJ/Q6CmXK5X+Soq+W/7+DaO8p";
        // cert = "MIIC/zCCAqOgAwIBAgIQGyeCk4o979VZ0RDhHHU48zAMBggqgRzPVQGDdQUAMC0xCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVNQ1NDQTEOMAwGA1UEAwwFTUNTQ0EwHhcNMjQwNTIwMDkwODMwWhcNMjUwNTIwMDkwODMwWjB4MQswCQYDVQQGEwJDTjEOMAwGA1UECgwFTUNTQ0ExEDAOBgNVBAsMB2xvY2FsUkExGzAZBgNVBAUMEjQyMDI4MTE5ODQxMTI1MTI2MzEqMCgGA1UEAwwhMTc4NDQ4Nzc0Njk1ODcwMDU0NUDorrjmhadAMDFAMDAxMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAEpvn+9wFZ48XD15KoQp3CTfoww2acsY+MW46v8K1dgMw2wWpwt6FTYAfzMSk3hzKMKJVXkjS1SwW3ksm2azrI9KOCAVYwggFSMB8GA1UdIwQYMBaAFLkj5hx/z7c8WCRbpAqtihGXenu2MB0GA1UdDgQWBBQfVOIxUyQ2zi20M0uO5g4imnn7IzBEBgNVHSAEPTA7MDkGByqBHIeECwEwLjAsBggrBgEFBQcCARYgaHR0cHM6Ly93d3cubWNzY2EuY29tLmNuL2Nwcy5odG0wCwYDVR0PBAQDAgTwMIG8BgNVHR8EgbQwgbEwLqAsoCqGKGh0dHA6Ly93d3cubWNzY2EuY29tLmNuL3NtMi9jcmwvY3JsMS5jcmwwf6B9oHuGeWxkYXA6Ly93d3cubWNzY2EuY29tLmNuOjEwMzg5L0NOPWNybDEsT1U9Q1JMLE89TUNTQ0EsQz1DTj9jZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0P2Jhc2U/b2JqZWN0Y2xhc3M9Y1JMRGlzdHJpYnV0aW9uUG9pbnQwDAYIKoEcz1UBg3UFAANIADBFAiEAgD/F1NV+6TapC+LHeR0VG5yasC3eMZSJjQhYUoOpIqMCIFhwyV7GbfaHrtaZvBPvYLdJs1igAlF7LLzwfy+NDCm+";
        // middleCertBase64 = "MIICgTCCAiWgAwIBAgIQVn7l0kAA6S9mVsDdu6k+oTAMBggqgRzPVQGDdQUAMC4xCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVOUkNBQzEPMA0GA1UEAwwGUk9PVENBMB4XDTE4MTEwNTAyMzU0N1oXDTM4MTAzMTAyMzU0N1owLTELMAkGA1UEBhMCQ04xDjAMBgNVBAoMBU1DU0NBMQ4wDAYDVQQDDAVNQ1NDQTBZMBMGByqGSM49AgEGCCqBHM9VAYItA0IABGL17gBv7xGY99pYA8IFH3H3VxbulydJGz5Fu3nYnx2FiU4BG8qLNCib5hnKzG6nVgeNel1IVKrsTX86CDQ6lj6jggEiMIIBHjAfBgNVHSMEGDAWgBRMMrGX2TMbxKYFwcbli2Jb8Jd2WDAPBgNVHRMBAf8EBTADAQH/MIG6BgNVHR8EgbIwga8wQaA/oD2kOzA5MQswCQYDVQQGEwJDTjEOMAwGA1UECgwFTlJDQUMxDDAKBgNVBAsMA0FSTDEMMAoGA1UEAwwDYXJsMCqgKKAmhiRodHRwOi8vd3d3LnJvb3RjYS5nb3YuY24vYXJsL2FybC5jcmwwPqA8oDqGOGxkYXA6Ly9sZGFwLnJvb3RjYS5nb3YuY246Mzg5L0NOPWFybCxPVT1BUkwsTz1OUkNBQyxDPUNOMA4GA1UdDwEB/wQEAwIBBjAdBgNVHQ4EFgQUuSPmHH/PtzxYJFukCq2KEZd6e7YwDAYIKoEcz1UBg3UFAANIADBFAiEA2HUeRfOn8spFQIkj9zbhVfc0qx9R8lwP40QcRWHIcMcCIHzDLXW5xAkevJaXFcsZJ/Q6CmXK5X+Soq+W/7+DaO8p";

        // cert = "MIIBsTCCAVSgAwIBAgIIGtAbnChFAgwwDAYIKoEcz1UBg3UFADBkMQswCQYDVQQGEwJDTjEyMDAGA1UECgwpTWFpbmxhbmQgU2VjdXJpdHkgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkxITAfBgNVBAMMGE1TQ0EgUHVibGljIFRFU1QgU00yIENBMTAeFw0yNDA2MTIwODIxMDlaFw0yNDA2MjIwODIxMDlaMFQxCzAJBgNVBAYTAkNOMRswGQYDVQQKDBLmtYvor5XkvIHkuJrlhazlj7gxKDAmBgNVBAMMH+a1i+ivlUNB5YiG5Y+RNDE1MGVhYTU4YkAwMkAwMDEwWTATBgcqhkjOPQIBBggqgRzPVQGCLQNCAATpB8F/ZKgCrzxYQxLYYwdx+bD7MeE2O+w47yuweLMYQVcbyi5T4zeCsU3tAahGTC2aeolLMzmOXQnnBIw1jabzMAwGCCqBHM9VAYN1BQADSQAwRgIhAIBFAy1ueawvgTB0e4yNtW/S6n1oGCTOo5HyTdIQW5FhAiEAvJyLpV2QIaqrN+Hfx/mIR7Jfeu3XznpLr8V/9maVzUM=";
        // middleCertBase64 = "MIICITCCAcWgAwIBAgIIQb6POR2NbYQwDAYIKoEcz1UBg3UFADBkMQswCQYDVQQGEwJDTjEyMDAGA1UECgwpTWFpbmxhbmQgU2VjdXJpdHkgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkxITAfBgNVBAMMGE1TQ0EgUHVibGljIFRFU1QgU00yIENBMTAgFw0yNDA2MTQwODI3NTlaGA8yMDU0MDYwNzA4Mjc1OVowZDELMAkGA1UEBhMCQ04xMjAwBgNVBAoMKU1haW5sYW5kIFNlY3VyaXR5IENlcnRpZmljYXRpb24gQXV0aG9yaXR5MSEwHwYDVQQDDBhNU0NBIFB1YmxpYyBURVNUIFNNMiBDQTEwWTATBgcqhkjOPQIBBggqgRzPVQGCLQNCAAS1gBrz4/itw0Hc6y5f5MErJQuWyQSz88WLwMlIUR5XhQLAOzwVYc3GZkGhZfvn5sKSWXaKmVl49vnaSTLsWIFKo10wWzALBgNVHQ8EBAMCAQYwDAYDVR0TBAUwAwEB/zAdBgNVHQ4EFgQURe9Fc1pkq1yjsnIDIWxgtKuaEyAwHwYDVR0jBBgwFoAURe9Fc1pkq1yjsnIDIWxgtKuaEyAwDAYIKoEcz1UBg3UFAANIADBFAiEAhdO3NhxfXgvdNy5SIlNpXAZNqO0C+AZJfvO20QEPh/sCIHDj23TzPnkaLUdt/NxZwyljY+AtA0umSSTZRg68tVfM";

        ASN1InputStream asn1InputStream = new ASN1InputStream(Base64.decode(cert));
        //将hex转换为byte输出
        ASN1Primitive asn1Primitive;
        while ((asn1Primitive = asn1InputStream.readObject()) != null) {
            ASN1Sequence sequence = (ASN1Sequence) asn1Primitive;
            // TBSCert
            ASN1Sequence tbsCert = (ASN1Sequence) sequence.getObjectAt(0);
            // System.out.println("TBScert>> "+ Hex.toHexString(tbsCert.getEncoded()));
            // 算法
            ASN1Sequence signAlg = (ASN1Sequence) sequence.getObjectAt(1);
            ASN1ObjectIdentifier alg = (ASN1ObjectIdentifier) signAlg.getObjectAt(0);
            // System.out.println(alg.getId());
            // 签名
            DERBitString sigValue = (DERBitString) sequence.getObjectAt(2);
            // System.out.println("SigValue>> "+ Hex.toHexString(sigValue.getOctets()));
            // 验签(用中间CA的公钥证书 验 TBSCert)
            ByteArrayInputStream bis = new ByteArrayInputStream(Base64.decode(middleCertBase64));
            Signature signature = Signature.getInstance("SM3withSM2", BC);
            // Signature signature = Signature.getInstance("SHA1WithRSA", "BC");
            CertificateFactory certificateFactory = CertificateFactory.getInstance("X.509", BC);
            Certificate middleCert = certificateFactory.generateCertificate(bis);
            signature.initVerify(middleCert.getPublicKey());
            signature.update(tbsCert.getEncoded());
            // System.out.println(signature.verify(Hex.decode("3044022100CCAD3E1C3E34B17809587B3BCBB6E553FA32778ECF021B46237D2545FB5BD4D0021F4C647CD04FB7A3AF2887D998EA021614597FE164A1C76A6BBC433F4AFBAA40")));
            boolean verify = signature.verify(sigValue.getOctets());
            // System.out.println(verify);
            return verify;
        }
        return false;
    }

    @Test
    @SneakyThrows
    public void vierify2() {
        String cert = "MIIC2jCCAkOgAwIBAgIBAzANBgkqhkiG9w0BAQUFADBYMQswCQYDVQQGEwJDTjEOMAwGA1UECgwFQ2hpbmExFTATBgNVBAsMDEludGVybWVkaWF0ZTEiMCAGCSqGSIb3DQEJARYTMTM5ODMwNTM0NTVAMTYzLmNvbTAeFw0yNDAxMjMwNzIwMzJaFw0yNTAxMjIwNzIwMzJaMGYxCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVDaGluYTESMBAGA1UEBwwJQ2hvbmdxaW5nMQ8wDQYDVQQDDAZHR0s5MTExIjAgBgkqhkiG9w0BCQEWEzEzOTgzMDUzNDU1QDE2My5jb20wWjANBgkqhkiG9w0BAQEFAANJADBGAkEAtKfkYXBXTxapcIKyK+WLaipil5hBm+EocqS9umJs+umQD3ar+xITnc5d5WVk+rK2VDFloEDGBoh0IOM9ke1+1wIBEaOB6zCB6DAdBgNVHQ4EFgQU0GzsbTWDvFUSGwzLPv7XJqYWZGgwHwYDVR0jBBgwFoAUlAgzbzJA94c32tEgqu0up27JyR4wCQYDVR0fBAIwADBfBggrBgEFBQcBAQEB/wRQME4wKAYIKwYBBQUHMAGCHGh0dHA6Ly8xMjcuMC4wLjEvY2Fpc3N1ZS5odG0wIgYIKwYBBQUHMAKCFmh0dHA6Ly8xMjcuMC4wLjE6MjA0NDMwDgYDVR0PAQH/BAQDAgbAMBIGA1UdEwEB/wQIMAYBAf8CAQMwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwgwDQYJKoZIhvcNAQEFBQADgYEAKqpSf7BFMOeWBHEuw7qR3SiNmBDPVYcSTQtKrY5z6dU1Dcz3M4pcTT2SGwQtEEAKwZsJOe2aACTkyXAoMCQed6NCeuIfBTSC4m7S10afTYKMoYYmJsgIWbxnnT91aEpJEBOqwYy2WhfunTFAQKRerBbjTixEOqIsSywUgBrodwA=";
        String middleCertBase64 = "MIICgzCCAeygAwIBAgIBAjANBgkqhkiG9w0BAQUFADAqMQswCQYDVQQGEwJDTjEOMAwGA1UECgwFQ2hpbmExCzAJBgNVBAsMAkNBMB4XDTI0MDEyMzA3MjAzMloXDTI5MDEyMTA3MjAzMlowWDELMAkGA1UEBhMCQ04xDjAMBgNVBAoMBUNoaW5hMRUwEwYDVQQLDAxJbnRlcm1lZGlhdGUxIjAgBgkqhkiG9w0BCQEWEzEzOTgzMDUzNDU1QDE2My5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAI3g0RPF5zaWnI0rBHokP4/hjtrWTN6ehC02aSMMpIb3z93h+O7FTRkF//BKzIXmEJPhgMrcbOpAfxk9RLsOlEm427SXhM2eNiYMOeBqlHKZl4xu2DAHJOiHGYz+3iDz+95lj6K9B4vpRqOSvTSfK0nEhuIMQFWI4wZwbJAXMI5pAgMA//+jgYowgYcwHQYDVR0OBBYEFJQIM28yQPeHN9rRIKrtLqduyckeMFIGA1UdIwRLMEmAFMA2GQetxIiXqF5yb2sJ6+Xm8SlcoS6kLDAqMQswCQYDVQQGEwJDTjEOMAwGA1UECgwFQ2hpbmExCzAJBgNVBAsMAkNBggEBMBIGA1UdEwEB/wQIMAYBAf8CAQAwDQYJKoZIhvcNAQEFBQADgYEArn/OqlUQhidMXWDTbbtYt3wzvSFESbgX3DSOv/WxKcp/FyUElLzZPZbMOKqOWQsZxphvNCGHCj026aclM5Q7Uuv0pfXFMj2L64hDruCirtQV2NrdKCCx4koM7I8hElXKXUzVohJymqWswpVosup0/n5rZXtONP8Y0w8Vfm1fKnk=";

        cert = "MIIBfDCCASCgAwIBAgIIRisNjo9ObPswDAYIKoEcz1UBg3UFADBkMQswCQYDVQQGEwJDTjEyMDAGA1UECgwpTWFpbmxhbmQgU2VjdXJpdHkgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkxITAfBgNVBAMMGE1TQ0EgUHVibGljIFRFU1QgU00yIENBMTAeFw0yNDA3MTAwNjIxMDlaFw0yNDA3MjAwNjIxMDlaMCAxCzAJBgNVBAYTAkNOMREwDwYDVQQDDAh0ZXN0MDAxMjBZMBMGByqGSM49AgEGCCqBHM9VAYItA0IABOkHwX9kqAKvPFhDEthjB3H5sPsx4TY77DjvK7B4sxhBVxvKLlPjN4KxTe0BqEZMLZp6iUszOY5dCecEjDWNpvMwDAYIKoEcz1UBg3UFAANIADBFAiAK7HubXxSG0BZXcovcUaRwMzaXXIRUt1kmMb18Il5qjwIhAIMMpZUiIwuY/H3zrywQ1Z//Ms5I7K/7dS1P/TecNMfA";
        middleCertBase64 = "MIICITCCAcWgAwIBAgIIQb6POR2NbYQwDAYIKoEcz1UBg3UFADBkMQswCQYDVQQGEwJDTjEyMDAGA1UECgwpTWFpbmxhbmQgU2VjdXJpdHkgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkxITAfBgNVBAMMGE1TQ0EgUHVibGljIFRFU1QgU00yIENBMTAgFw0yNDA2MTQwODI3NTlaGA8yMDU0MDYwNzA4Mjc1OVowZDELMAkGA1UEBhMCQ04xMjAwBgNVBAoMKU1haW5sYW5kIFNlY3VyaXR5IENlcnRpZmljYXRpb24gQXV0aG9yaXR5MSEwHwYDVQQDDBhNU0NBIFB1YmxpYyBURVNUIFNNMiBDQTEwWTATBgcqhkjOPQIBBggqgRzPVQGCLQNCAAS1gBrz4/itw0Hc6y5f5MErJQuWyQSz88WLwMlIUR5XhQLAOzwVYc3GZkGhZfvn5sKSWXaKmVl49vnaSTLsWIFKo10wWzALBgNVHQ8EBAMCAQYwDAYDVR0TBAUwAwEB/zAdBgNVHQ4EFgQURe9Fc1pkq1yjsnIDIWxgtKuaEyAwHwYDVR0jBBgwFoAURe9Fc1pkq1yjsnIDIWxgtKuaEyAwDAYIKoEcz1UBg3UFAANIADBFAiEAhdO3NhxfXgvdNy5SIlNpXAZNqO0C+AZJfvO20QEPh/sCIHDj23TzPnkaLUdt/NxZwyljY+AtA0umSSTZRg68tVfM";

        cert = "MIIDODCCAiCgAwIBAgIHBGLVN+fvTjANBgkqhkiG9w0BAQsFADAyMQswCQYDVQQGEwJDTjEPMA0GA1UEChMGTUlOSUNBMRIwEAYDVQQDEwlST09UUlNBQ0EwHhcNMjQwNzEzMDc0NjQyWhcNMjkwNzEyMDc0NjQyWjAiMQ8wDQYDVQQGEwZNSU5JQ0ExDzANBgNVBAMTBmdnazkxMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALRdweGlxI2HNvm/lvhF/U1n4GJbryicyDFMGp2G7AQq4WSPtiAdGB/O6iAouqO7UB/l9YmfzDCWa7tzQbYK3j+CwiFk3P5JmoJcmV3dKspDlfCB1FsVri5h1ReBC8mVuCUPNdzrQOj9312u55RGGibftYC2IKlDBAjNW8vWg0ozMPRwFy14g1370EZt9yI5Mi92ZWbpIWtbSPsPH+y6bob1Bp+1yQL8zu3oVjVxlkBu+e61wNru0CydaW9//dkdszvdJS/DyFBR3yEaLcwtiRGlnkp9dP6XJiSJ9dEbg99+84jIeqRmaPYq9DYZqDLzN8vf6RbAov1gR0TZkz8w5o0CAwEAAaNjMGEwHQYDVR0OBBYEFAl21ms+AHOyKC636wzfL1cLiE3kMB8GA1UdIwQYMBaAFAl21ms+AHOyKC636wzfL1cLiE3kMAsGA1UdDwQEAwIBBjASBgNVHRMBAf8ECDAGAQH/AgEDMA0GCSqGSIb3DQEBCwUAA4IBAQBadULYXqskNVfo5268mX+xTmDbRSuL5nLH0deNhLjZ8vjgiNCHLx6pwdmc/6OeRos02oJFKSy+WUtYGxw/L8WhhjrxIBZ7AS0brs5ftQypDa2LqWbFrUTLuZiRpnMw9ShzbbsXiZIqkluMgtKi7bdjd7qKBjZ6CMAVx9zKDc/sguWAHEvXToUNCwpuvAHvJecvqwGeoHMXbfXgZ33K97ugeggg8vKVm51LHyQsaaO9DZzJcWUbDIr298IQ92HoH8UrdkSGfBPrLnso4M+WIF6CxahTfQ4vUONuixz/dCii7iWPcN2pg4JLgK8Knt72HjUPvnE+Hz6uYkMeYWU8oQUO";
        middleCertBase64 = "MIIDSDCCAjCgAwIBAgIHBGLVN+fvTjANBgkqhkiG9w0BAQsFADAyMQswCQYDVQQGEwJDTjEPMA0GA1UEChMGTUlOSUNBMRIwEAYDVQQDEwlST09UUlNBQ0EwHhcNMjQwNzEzMDcyNjIzWhcNMjkwNzEyMDcyNjIzWjAyMQswCQYDVQQGEwJDTjEPMA0GA1UEChMGTUlOSUNBMRIwEAYDVQQDEwlST09UUlNBQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC0XcHhpcSNhzb5v5b4Rf1NZ+BiW68onMgxTBqdhuwEKuFkj7YgHRgfzuogKLqju1Af5fWJn8wwlmu7c0G2Ct4/gsIhZNz+SZqCXJld3SrKQ5XwgdRbFa4uYdUXgQvJlbglDzXc60Do/d9drueURhom37WAtiCpQwQIzVvL1oNKMzD0cBcteINd+9BGbfciOTIvdmVm6SFrW0j7Dx/sum6G9QaftckC/M7t6FY1cZZAbvnutcDa7tAsnWlvf/3ZHbM73SUvw8hQUd8hGi3MLYkRpZ5KfXT+lyYkifXRG4PffvOIyHqkZmj2KvQ2Gagy8zfL3+kWwKL9YEdE2ZM/MOaNAgMBAAGjYzBhMB0GA1UdDgQWBBQJdtZrPgBzsigut+sM3y9XC4hN5DAfBgNVHSMEGDAWgBQJdtZrPgBzsigut+sM3y9XC4hN5DALBgNVHQ8EBAMCAQYwEgYDVR0TAQH/BAgwBgEB/wIBAzANBgkqhkiG9w0BAQsFAAOCAQEAm+CAwowLqGaitBrayoy5THj8Twu75OExkSOObxjxOoej5V7GZbF7Z7ZpKD9o3/sPic8Qf7O3RNVcFX5B4plBSjmL7tqzmDZzQDY0Yj3VVX9kijwhhPLgvZz1qYlnUNChKAB9qaa9SMLEDnSOiqZb61WWW5aHaGzt6SIl0UIt4v+e7o7yNpWY6Va9HrV1IpBHIUZkuoU7zMWFxCJ1jAPtXSgbSgY+omC1mYsqVIOxtmnD2q5TWi1a3JoBbQMHeT73G19fUWXhidh4h2hDeYOndKGbyNJVh/aW18/VgeISClm3HunjIPzZjAvBOFCXmRMRIn679pbTk/agHiAtPi5BLA==";

        cert = "MIIBrTCCAVSgAwIBAgIJANrkluUdZlLTMAoGCCqBHM9VAYN1MDIxCzAJBgNVBAYTAkNOMQ8wDQYDVQQKEwZNSU5JQ0ExEjAQBgNVBAMTCVJPT1RTTTJDQTAeFw0yNDA3MTMwNzU5NTNaFw0yOTA3MTIwNzU5NTNaMCIxDzANBgNVBAYTBk1JTklDQTEPMA0GA1UEAxMGZ2drOTExMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAEf0PJKadySD84NTuwPBqfxKIHjQXigLAK5ydxatEt7jvUdCfExtWsoOEDq+Kups1qy0xsYv/sREJ1DFfi2EjjfKNjMGEwHQYDVR0OBBYEFOARhhxjAyGNHIYBJtv7Ye1tQNPqMB8GA1UdIwQYMBaAFOARhhxjAyGNHIYBJtv7Ye1tQNPqMAsGA1UdDwQEAwIBBjASBgNVHRMBAf8ECDAGAQH/AgEDMAoGCCqBHM9VAYN1A0cAMEQCIHFGmDoLxBqpcWsErvjGSVVeAQVeSYxUYcZA+AtsDG1NAiBqegBhBYP6IWs4PYapAvWVeU5dwr8/gunzjLiksygyiA==";
        middleCertBase64 = "MIIBvDCCAWKgAwIBAgIHBGLVN+fvTjAKBggqgRzPVQGDdTAyMQswCQYDVQQGEwJDTjEPMA0GA1UEChMGTUlOSUNBMRIwEAYDVQQDEwlST09UU00yQ0EwHhcNMjQwNzEzMDcyOTIyWhcNMjkwNzEyMDcyOTIyWjAyMQswCQYDVQQGEwJDTjEPMA0GA1UEChMGTUlOSUNBMRIwEAYDVQQDEwlST09UU00yQ0EwWTATBgcqhkjOPQIBBggqgRzPVQGCLQNCAAR/Q8kpp3JIPzg1O7A8Gp/EogeNBeKAsArnJ3Fq0S3uO9R0J8TG1ayg4QOr4q6mzWrLTGxi/+xEQnUMV+LYSON8o2MwYTAdBgNVHQ4EFgQU4BGGHGMDIY0chgEm2/th7W1A0+owHwYDVR0jBBgwFoAU4BGGHGMDIY0chgEm2/th7W1A0+owCwYDVR0PBAQDAgEGMBIGA1UdEwEB/wQIMAYBAf8CAQMwCgYIKoEcz1UBg3UDSAAwRQIhAObRZYxRdmMaA5fvNoKC0h/0LamTImyiaq49FQlmPAzyAiBj/BqJ0yYJXXfCC7ZYKLYasxy0bI4T/DkF+2Ptnh3KdQ==";

        cert = "MIICvjCCAmGgAwIBAgIQOiskdlllr+YtN4mhQ1xemDAMBggqgRzPVQGDdQUAMC0xCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVNQ1NDQTEOMAwGA1UEAwwFTUNTQ0EwHhcNMjQwNzE1MDI0OTM4WhcNMjcwNzE1MDI0OTM4WjB7MQswCQYDVQQGEwJDTjEOMAwGA1UECgwFTUNTQ0ExEDAOBgNVBAsMB2xvY2FsUkExGzAZBgNVBAUMEjUwMDEwMjE5OTQxMjA0NzEwMjEtMCsGA1UEAwwkMTI5MDIwOTYxOTE2MzE1NjQ4MEDotbXnjq7nkKZAMDFAMDAxMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAExfw4FN18k1KT13yyQTBM7Wrk3m7+I7ov0X6CL6YSxQdNy1nNAH1fL6I4YnQnw/xxKFe7bqcCOIQTTetgLxyhCqOCAREwggENMAsGA1UdDwQEAwIDODCBvQYDVR0fBIG1MIGyMC+gLaArhilodHRwczovL3d3dy5tY3NjYS5jb20uY24vc20yL2NybC9jcmwxLmNybDB/oH2ge4Z5bGRhcDovL3d3dy5tY3NjYS5jb20uY246MTAzODkvQ049Y3JsMSxPVT1DUkwsTz1NQ1NDQSxDPUNOP2NlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3Q/YmFzZT9vYmplY3RjbGFzcz1jUkxEaXN0cmlidXRpb25Qb2ludDAdBgNVHQ4EFgQU2VK6NwCfkAzaKL1ig44u6C6adR8wHwYDVR0jBBgwFoAUuSPmHH/PtzxYJFukCq2KEZd6e7YwDAYIKoEcz1UBg3UFAANJADBGAiEAv04BORdoYfzZRVxgbslSWdfuvM7Anrdm/R7UtOTp8MoCIQCHEY+1AGTt+yuwpj5yzDBhtjejXYqj2QtFEXE0OKMfKQ==";
        cert = "MIIDAjCCAqagAwIBAgIQJo35gkbWzP8rGp+QpoE+qzAMBggqgRzPVQGDdQUAMC0xCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVNQ1NDQTEOMAwGA1UEAwwFTUNTQ0EwHhcNMjQwOTA2MDIxODM5WhcNMjUwMTA2MDIxODM5WjB7MQswCQYDVQQGEwJDTjEOMAwGA1UECgwFTUNTQ0ExEDAOBgNVBAsMB2xvY2FsUkExGzAZBgNVBAUMEjM3MTcyNDIwMDIwNjA1MjIxMDEtMCsGA1UEAwwkMTgxMDg2Mzc3Mzg1OTY4ODQ0OEDllJDlpb3lh69AMDFAMDUyMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAE8jwlOAwUyNTF1f8whx3itGN32g4/rGSw44fZ6P22Nazl2oN4vH0aWtbjP4FUXmI5VfMfZfz2OeSgdZjgtZK3zKOCAVYwggFSMAsGA1UdDwQEAwIE8DAfBgNVHSMEGDAWgBS5I+Ycf8+3PFgkW6QKrYoRl3p7tjAdBgNVHQ4EFgQUPnYS4Bqv/35orL6cyxiKgsd+uLYwgbwGA1UdHwSBtDCBsTAuoCygKoYoaHR0cDovL3d3dy5tY3NjYS5jb20uY24vc20yL2NybC9jcmwxLmNybDB/oH2ge4Z5bGRhcDovL3d3dy5tY3NjYS5jb20uY246MTAzODkvQ049Y3JsMSxPVT1DUkwsTz1NQ1NDQSxDPUNOP2NlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3Q/YmFzZT9vYmplY3RjbGFzcz1jUkxEaXN0cmlidXRpb25Qb2ludDBEBgNVHSAEPTA7MDkGByqBHIeECwIwLjAsBggrBgEFBQcCARYgaHR0cHM6Ly93d3cubWNzY2EuY29tLmNuL2Nwcy5odG0wDAYIKoEcz1UBg3UFAANIADBFAiAGNLwM18hEYPsOOWzWXJ/ryDP5Tn3ie7lQ2i3Vu7mDBgIhAIAOeKvm30AhjVzJ0zAFhYjVhC8dHofNjW2Dwv4XmyN7";

        cert = "MIIC9TCCApmgAwIBAgIQaxlxj6PONXVAZS9jSqFHxzAMBggqgRzPVQGDdQUAMC0xCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVNQ1NDQTEOMAwGA1UEAwwFTUNTQ0EwHhcNMjQxMDIyMDQyNzQyWhcNMjUxMDIyMDQyNzQyWjBsMQswCQYDVQQGEwJDTjEOMAwGA1UECgwFTUNTQ0ExEDAOBgNVBAsMB2xvY2FsUkExGzAZBgNVBAUMEjQ1MjEyNDE5ODMwNDI5MDAyNjEeMBwGA1UEAwwVSERKVEDlvKDnkLzkuLlAMDFAMDAxMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAE2A05SqTF4dj+856V7m0WP/PQDegYgjRzRGfwNyx6zjVvNIu1yyqZ1zNoVRoG7W4v2fF5kaF0MzolZSQe0kKG+qOCAVgwggFUMAsGA1UdDwQEAwIE8DAfBgNVHSMEGDAWgBS5I+Ycf8+3PFgkW6QKrYoRl3p7tjAdBgNVHQ4EFgQUrPZnUIfjxqkTao08WzMYQqMEQAcwgb4GA1UdHwSBtjCBszAuoCygKoYoaHR0cDovL3d3dy5tY3NjYS5jb20uY24vc20yL2NybC9jcmwxLmNybDCBgKB+oHyGemxkYXA6Ly9sZGFwLm1jc2NhLmNvbS5jbjoxMDM4OS9DTj1jcmwxLE9VPUNSTCxPPU1DU0NBLEM9Q04/Y2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdD9iYXNlP29iamVjdGNsYXNzPWNSTERpc3RyaWJ1dGlvblBvaW50MEQGA1UdIAQ9MDswOQYHKoEch4QLATAuMCwGCCsGAQUFBwIBFiBodHRwczovL3d3dy5tY3NjYS5jb20uY24vY3BzLmh0bTAMBggqgRzPVQGDdQUAA0gAMEUCIQDMrT4cPjSxeAlYezvLtuVT+jJ3js8CG0YjfSVF+1vU0AIgAExkfNBPt6OvKIfZmOoCFhRZf+Fkocdqa7xDP0r7qkA=";
        cert = "MIIC9DCCApmgAwIBAgIQaxlxj6PONXVAZS9jSqFHxzAMBggqgRzPVQGDdQUAMC0xCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVNQ1NDQTEOMAwGA1UEAwwFTUNTQ0EwHhcNMjQxMDIyMDQyNzQyWhcNMjUxMDIyMDQyNzQyWjBsMQswCQYDVQQGEwJDTjEOMAwGA1UECgwFTUNTQ0ExEDAOBgNVBAsMB2xvY2FsUkExGzAZBgNVBAUMEjQ1MjEyNDE5ODMwNDI5MDAyNjEeMBwGA1UEAwwVSERKVEDlvKDnkLzkuLlAMDFAMDAxMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAE2A05SqTF4dj+856V7m0WP/PQDegYgjRzRGfwNyx6zjVvNIu1yyqZ1zNoVRoG7W4v2fF5kaF0MzolZSQe0kKG+qOCAVgwggFUMAsGA1UdDwQEAwIE8DAfBgNVHSMEGDAWgBS5I+Ycf8+3PFgkW6QKrYoRl3p7tjAdBgNVHQ4EFgQUrPZnUIfjxqkTao08WzMYQqMEQAcwgb4GA1UdHwSBtjCBszAuoCygKoYoaHR0cDovL3d3dy5tY3NjYS5jb20uY24vc20yL2NybC9jcmwxLmNybDCBgKB+oHyGemxkYXA6Ly9sZGFwLm1jc2NhLmNvbS5jbjoxMDM4OS9DTj1jcmwxLE9VPUNSTCxPPU1DU0NBLEM9Q04/Y2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdD9iYXNlP29iamVjdGNsYXNzPWNSTERpc3RyaWJ1dGlvblBvaW50MEQGA1UdIAQ9MDswOQYHKoEch4QLATAuMCwGCCsGAQUFBwIBFiBodHRwczovL3d3dy5tY3NjYS5jb20uY24vY3BzLmh0bTAMBggqgRzPVQGDdQUAA0cAMEQCIQDMrT4cPjSxeAlYezvLtuVT+jJ3js8CG0YjfSVF+1vU0AIfTGR80E+3o68oh9mY6gIWFFl/4WShx2prvEM/SvuqQA==";

        // 生产sm2根 b923e61c7fcfb73c58245ba40aad8a11977a7bb6
        middleCertBase64 = "MIICgTCCAiWgAwIBAgIQVn7l0kAA6S9mVsDdu6k+oTAMBggqgRzPVQGDdQUAMC4xCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVOUkNBQzEPMA0GA1UEAwwGUk9PVENBMB4XDTE4MTEwNTAyMzU0N1oXDTM4MTAzMTAyMzU0N1owLTELMAkGA1UEBhMCQ04xDjAMBgNVBAoMBU1DU0NBMQ4wDAYDVQQDDAVNQ1NDQTBZMBMGByqGSM49AgEGCCqBHM9VAYItA0IABGL17gBv7xGY99pYA8IFH3H3VxbulydJGz5Fu3nYnx2FiU4BG8qLNCib5hnKzG6nVgeNel1IVKrsTX86CDQ6lj6jggEiMIIBHjAfBgNVHSMEGDAWgBRMMrGX2TMbxKYFwcbli2Jb8Jd2WDAPBgNVHRMBAf8EBTADAQH/MIG6BgNVHR8EgbIwga8wQaA/oD2kOzA5MQswCQYDVQQGEwJDTjEOMAwGA1UECgwFTlJDQUMxDDAKBgNVBAsMA0FSTDEMMAoGA1UEAwwDYXJsMCqgKKAmhiRodHRwOi8vd3d3LnJvb3RjYS5nb3YuY24vYXJsL2FybC5jcmwwPqA8oDqGOGxkYXA6Ly9sZGFwLnJvb3RjYS5nb3YuY246Mzg5L0NOPWFybCxPVT1BUkwsTz1OUkNBQyxDPUNOMA4GA1UdDwEB/wQEAwIBBjAdBgNVHQ4EFgQUuSPmHH/PtzxYJFukCq2KEZd6e7YwDAYIKoEcz1UBg3UFAANIADBFAiEA2HUeRfOn8spFQIkj9zbhVfc0qx9R8lwP40QcRWHIcMcCIHzDLXW5xAkevJaXFcsZJ/Q6CmXK5X+Soq+W/7+DaO8p";


        boolean verifyByIssueCert = CertVerifyUtil.verifyByIssueCert(middleCertBase64, cert);
        System.out.println(verifyByIssueCert);
        boolean verifySign = certTest(cert, middleCertBase64);
        System.out.println(verifySign);
    }

    @Test
    @SneakyThrows
    public void batchVerify() {
        String rootCertBase = "MIICITCCAcWgAwIBAgIIQb6POR2NbYQwDAYIKoEcz1UBg3UFADBkMQswCQYDVQQGEwJDTjEyMDAGA1UECgwpTWFpbmxhbmQgU2VjdXJpdHkgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkxITAfBgNVBAMMGE1TQ0EgUHVibGljIFRFU1QgU00yIENBMTAgFw0yNDA2MTQwODI3NTlaGA8yMDU0MDYwNzA4Mjc1OVowZDELMAkGA1UEBhMCQ04xMjAwBgNVBAoMKU1haW5sYW5kIFNlY3VyaXR5IENlcnRpZmljYXRpb24gQXV0aG9yaXR5MSEwHwYDVQQDDBhNU0NBIFB1YmxpYyBURVNUIFNNMiBDQTEwWTATBgcqhkjOPQIBBggqgRzPVQGCLQNCAAS1gBrz4/itw0Hc6y5f5MErJQuWyQSz88WLwMlIUR5XhQLAOzwVYc3GZkGhZfvn5sKSWXaKmVl49vnaSTLsWIFKo10wWzALBgNVHQ8EBAMCAQYwDAYDVR0TBAUwAwEB/zAdBgNVHQ4EFgQURe9Fc1pkq1yjsnIDIWxgtKuaEyAwHwYDVR0jBBgwFoAURe9Fc1pkq1yjsnIDIWxgtKuaEyAwDAYIKoEcz1UBg3UFAANIADBFAiEAhdO3NhxfXgvdNy5SIlNpXAZNqO0C+AZJfvO20QEPh/sCIHDj23TzPnkaLUdt/NxZwyljY+AtA0umSSTZRg68tVfM";
        String certFilePath = "D:\\2024-07-10";
        File file = FileUtil.file(certFilePath);
        if (file.isDirectory()) {
            File[] cerFiles = file.listFiles();
            for (File cerFile : cerFiles) {
                if (cerFile.getPath().contains(".cer")) {
                    String certBase64 = FileUtil.readString(cerFile, StandardCharsets.UTF_8);
                    boolean verify = certTest(certBase64, rootCertBase);
                    System.out.println("cert:" + cerFile.getName() + ",verify:" + verify);
                }
            }
        }

    }

    // @Test
    // @SneakyThrows
    // public void errorSignCertFix() {
    //     String cert = "MIIC/zCCAqOgAwIBAgIQGyeCk4o979VZ0RDhHHU48zAMBggqgRzPVQGDdQUAMC0xCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVNQ1NDQTEOMAwGA1UEAwwFTUNTQ0EwHhcNMjQwNTIwMDkwODMwWhcNMjUwNTIwMDkwODMwWjB4MQswCQYDVQQGEwJDTjEOMAwGA1UECgwFTUNTQ0ExEDAOBgNVBAsMB2xvY2FsUkExGzAZBgNVBAUMEjQyMDI4MTE5ODQxMTI1MTI2MzEqMCgGA1UEAwwhMTc4NDQ4Nzc0Njk1ODcwMDU0NUDorrjmhadAMDFAMDAxMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAEpvn+9wFZ48XD15KoQp3CTfoww2acsY+MW46v8K1dgMw2wWpwt6FTYAfzMSk3hzKMKJVXkjS1SwW3ksm2azrI9KOCAVYwggFSMB8GA1UdIwQYMBaAFLkj5hx/z7c8WCRbpAqtihGXenu2MB0GA1UdDgQWBBQfVOIxUyQ2zi20M0uO5g4imnn7IzBEBgNVHSAEPTA7MDkGByqBHIeECwEwLjAsBggrBgEFBQcCARYgaHR0cHM6Ly93d3cubWNzY2EuY29tLmNuL2Nwcy5odG0wCwYDVR0PBAQDAgTwMIG8BgNVHR8EgbQwgbEwLqAsoCqGKGh0dHA6Ly93d3cubWNzY2EuY29tLmNuL3NtMi9jcmwvY3JsMS5jcmwwf6B9oHuGeWxkYXA6Ly93d3cubWNzY2EuY29tLmNuOjEwMzg5L0NOPWNybDEsT1U9Q1JMLE89TUNTQ0EsQz1DTj9jZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0P2Jhc2U/b2JqZWN0Y2xhc3M9Y1JMRGlzdHJpYnV0aW9uUG9pbnQwDAYIKoEcz1UBg3UFAANIADBFAiCAP8XU1X7pNqkL4sd5HRUbnJqwLd4xlImNCFhSg6kiowIgWHDJXsZt9oeu1pm8E+9gt0mzWKACUXssvPB/L40MKb4A";
    //     ASN1InputStream asn1InputStream = new ASN1InputStream(Base64.decode(cert));
    //     //将hex转换为byte输出
    //     ASN1Primitive asn1Primitive;
    //     while ((asn1Primitive = asn1InputStream.readObject()) != null) {
    //         ASN1Sequence sequence = (ASN1Sequence) asn1Primitive;
    //         // TBSCert
    //         ASN1Sequence tbsCert = (ASN1Sequence) sequence.getObjectAt(0);
    //         System.out.println("TBScert>> "+ Hex.toHexString(tbsCert.getEncoded()));
    //         // 算法
    //         ASN1Sequence signAlg = (ASN1Sequence) sequence.getObjectAt(1);
    //         ASN1ObjectIdentifier alg = (ASN1ObjectIdentifier) signAlg.getObjectAt(0);
    //         System.out.println(alg.getId());
    //         // 签名
    //         DERBitString sigValue = (DERBitString) sequence.getObjectAt(2);
    //         System.out.println("SigValue>> "+ Hex.toHexString(sigValue.getOctets()));
    //         // 验签(用中间CA的公钥证书 验 TBSCert)
    //         ByteArrayInputStream bis = new ByteArrayInputStream(Base64.decode(middleCertBase64));
    //         Signature signature = Signature.getInstance("SM3withSM2", BC);
    //         // Signature signature = Signature.getInstance("SHA1WithRSA", "BC");
    //         CertificateFactory certificateFactory = CertificateFactory.getInstance("X.509", BC);
    //         Certificate middleCert = certificateFactory.generateCertificate(bis);
    //         signature.initVerify(middleCert.getPublicKey());
    //         signature.update(tbsCert.getEncoded());
    //         // System.out.println(signature.verify(Hex.decode("3045022100803fc5d4d57ee936a90be2c7791d151b9c9ab02dde3194898d08585283a922a302205870c95ec66df687aed699bc13ef60b749b358a002517b2cbcf07f2f8d0c29be")));
    //         System.out.println(signature.verify(sigValue.getOctets()));
    //     }
    // }

}
